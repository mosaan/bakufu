name: "Text Summarizer"
description: "é•·ã„ãƒ†ã‚­ã‚¹ãƒˆã‚’åˆ†ã‹ã‚Šã‚„ã™ãè¦ç´„ã™ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼"

input_parameters:
  - name: "text"
    type: "string"
    required: true
    description: "è¦ç´„ã—ãŸã„ãƒ†ã‚­ã‚¹ãƒˆ"
  - name: "max_length"
    type: "integer"
    required: false
    description: "è¦ç´„ã®æœ€å¤§æ–‡å­—æ•°"
    default: 200

steps:
  - id: "text_analysis"
    type: "text_process"
    description: "ãƒ†ã‚­ã‚¹ãƒˆã®é•·ã•ã‚’ç¢ºèª"
    method: "json_parse"
    input: |
      {
        "original_length": {{ input.text | length }},
        "target_length": {{ input.max_length }}
      }

  - id: "summarize"
    type: "ai_call"
    description: "ãƒ†ã‚­ã‚¹ãƒˆã‚’è¦ç´„"
    prompt: |
      ä»¥ä¸‹ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’{{ input.max_length }}æ–‡å­—ä»¥å†…ã§è¦ç´„ã—ã¦ãã ã•ã„ã€‚
      é‡è¦ãªãƒã‚¤ãƒ³ãƒˆã‚’é€ƒã•ãšã€ç°¡æ½”ã§èª­ã¿ã‚„ã™ã„æ–‡ç« ã«ã—ã¦ãã ã•ã„ã€‚

      åŸæ–‡ï¼š
      {{ input.text }}

      è¦ç´„ã®æ¡ä»¶ï¼š
      - {{ input.max_length }}æ–‡å­—ä»¥å†…
      - é‡è¦ãªãƒã‚¤ãƒ³ãƒˆã‚’å«ã‚ã‚‹
      - èª­ã¿ã‚„ã™ã„æ—¥æœ¬èª
      - ç®‡æ¡æ›¸ãã§ã¯ãªãæ–‡ç« ã§

  - id: "format_output"
    type: "text_process"
    description: "çµæœã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ"
    method: "replace"
    input: |
      ğŸ“„ è¦ç´„çµæœ

      ã€åŸæ–‡ã€‘{{ steps.text_analysis.original_length }}æ–‡å­—
      ã€è¦ç´„ã€‘{{ steps.summarize | length }}æ–‡å­—ï¼ˆç›®æ¨™: {{ steps.text_analysis.target_length }}æ–‡å­—ï¼‰

      {{ steps.summarize }}
    replacements:
      - from: "{{ steps.summarize | length }}"
        to: "ç´„{{ (steps.summarize | length) }}æ–‡å­—"

output:
  format: "text"
  template: "{{ steps.format_output }}"