name: "Email Template Generator"
description: "ç›®çš„ã«å¿œã˜ãŸãƒ“ã‚¸ãƒã‚¹ãƒ¡ãƒ¼ãƒ«ã®æ–‡é¢ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼"

input_parameters:
  - name: "purpose"
    type: "string"
    required: true
    description: "ãƒ¡ãƒ¼ãƒ«ã®ç›®çš„ï¼ˆä¾‹ï¼šå•ã„åˆã‚ã›ã€ææ¡ˆã€è¬ç½ªã€ãŠç¤¼ãªã©ï¼‰"
  - name: "recipient"
    type: "string"
    required: true
    description: "é€ä¿¡å…ˆï¼ˆä¾‹ï¼šå–å¼•å…ˆã€ä¸Šå¸ã€ãŠå®¢æ§˜ãªã©ï¼‰"
  - name: "tone"
    type: "string"
    required: false
    description: "æ–‡é¢ã®ãƒˆãƒ¼ãƒ³"
    default: "ä¸å¯§ã§è¦ªã—ã¿ã‚„ã™ã„"
  - name: "key_points"
    type: "string"
    required: false
    description: "ä¼ãˆãŸã„è¦ç‚¹"
    default: ""

steps:
  - id: "analyze_context"
    type: "ai_call"
    description: "æ–‡è„ˆã‚’åˆ†æ"
    prompt: |
      ä»¥ä¸‹ã®æƒ…å ±ã‹ã‚‰ãƒ¡ãƒ¼ãƒ«ä½œæˆã®æ–‡è„ˆã‚’åˆ†æã—ã¦ãã ã•ã„ï¼š

      - ç›®çš„: {{ input.purpose }}
      - å—ä¿¡è€…: {{ input.recipient }}
      - ãƒˆãƒ¼ãƒ³: {{ input.tone }}
      - è¦ç‚¹: {{ input.key_points or "ç‰¹ã«æŒ‡å®šãªã—" }}

      ã“ã®ãƒ¡ãƒ¼ãƒ«ã«é©ã—ãŸï¼š
      1. ä»¶åæ¡ˆï¼ˆ3ã¤ï¼‰
      2. æ•¬èªãƒ¬ãƒ™ãƒ«ï¼ˆä¸å¯§èªãƒ»å°Šæ•¬èªãƒ»è¬™è­²èªã®ä½¿ã„åˆ†ã‘ï¼‰
      3. æ§‹æˆæ¡ˆï¼ˆæŒ¨æ‹¶ãƒ»æœ¬æ–‡ãƒ»ç· ã‚ï¼‰
      4. æ³¨æ„ç‚¹

      ã‚’ææ¡ˆã—ã¦ãã ã•ã„ã€‚

  - id: "create_subject"
    type: "text_process"
    description: "ä»¶åã‚’é¸æŠ"
    method: "regex_extract"
    input: "{{ steps.analyze_context }}"
    pattern: 'ä»¶åæ¡ˆ[ï¼š:]\s*(.+?)(?=\n|$)'
    output_format: "string"

  - id: "write_greeting"
    type: "ai_call"
    description: "æŒ¨æ‹¶éƒ¨åˆ†ã‚’ä½œæˆ"
    prompt: |
      {{ input.recipient }}å‘ã‘ã®ãƒ¡ãƒ¼ãƒ«ã®æŒ¨æ‹¶éƒ¨åˆ†ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

      è¦ä»¶:
      - {{ input.tone }}ãªæ–‡ä½“
      - {{ input.purpose }}ã®æ–‡è„ˆã«é©ã—ãŸæŒ¨æ‹¶
      - æ—¥æœ¬ã®ãƒ“ã‚¸ãƒã‚¹ãƒãƒŠãƒ¼ã«æº–æ‹ 

      æŒ¨æ‹¶éƒ¨åˆ†ã®ã¿ã‚’è¿”ã—ã¦ãã ã•ã„ï¼ˆæœ¬æ–‡ã¯å«ã‚ãªã„ï¼‰ã€‚

  - id: "write_body"
    type: "ai_call"
    description: "æœ¬æ–‡ã‚’ä½œæˆ"
    prompt: |
      ãƒ¡ãƒ¼ãƒ«ã®æœ¬æ–‡ã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š

      ç›®çš„: {{ input.purpose }}
      å—ä¿¡è€…: {{ input.recipient }}
      ãƒˆãƒ¼ãƒ³: {{ input.tone }}
      {% if input.key_points %}
      ä¼ãˆãŸã„è¦ç‚¹: {{ input.key_points }}
      {% endif %}

      è¦ä»¶:
      - ç°¡æ½”ã§åˆ†ã‹ã‚Šã‚„ã™ã„æ–‡ç« 
      - ç›¸æ‰‹ã®ç«‹å ´ã‚’è€ƒæ…®ã—ãŸå†…å®¹
      - å…·ä½“çš„ã§è¡Œå‹•ã«ã¤ãªãŒã‚‹å†…å®¹
      - é©åˆ‡ãªæ•¬èªã®ä½¿ç”¨

      æœ¬æ–‡éƒ¨åˆ†ã®ã¿ã‚’è¿”ã—ã¦ãã ã•ã„ã€‚

  - id: "write_closing"
    type: "ai_call"
    description: "ç· ã‚ã®æŒ¨æ‹¶ã‚’ä½œæˆ"
    prompt: |
      {{ input.purpose }}ã®ç›®çš„ã§{{ input.recipient }}ã«é€ã‚‹ãƒ¡ãƒ¼ãƒ«ã®ç· ã‚ã®æŒ¨æ‹¶ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

      æ–‡ä½“: {{ input.tone }}

      è¦ä»¶:
      - é©åˆ‡ãªçµã³ã®è¨€è‘‰
      - æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒæ˜ç¢º
      - ç›¸æ‰‹ã¸ã®é…æ…®ã‚’ç¤ºã™
      - æ—¥æœ¬ã®ãƒ“ã‚¸ãƒã‚¹æ…£ç¿’ã«æº–æ‹ 

      ç· ã‚ã®æŒ¨æ‹¶ã®ã¿ã‚’è¿”ã—ã¦ãã ã•ã„ã€‚

  - id: "assemble_email"
    type: "text_process"
    description: "ãƒ¡ãƒ¼ãƒ«å…¨ä½“ã‚’çµ„ã¿ç«‹ã¦"
    method: "replace"
    input: |
      ä»¶å: {{ steps.create_subject }}
      
      {{ steps.write_greeting }}
      
      {{ steps.write_body }}
      
      {{ steps.write_closing }}
      
      ï¼»ç½²åï¼½
    replacements:
      - from: "ï¼»ç½²åï¼½"
        to: |
          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          [ãŠåå‰]
          [ä¼šç¤¾åãƒ»éƒ¨ç½²å]
          [é€£çµ¡å…ˆ]
          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

output:
  format: "text"
  template: |
    ğŸ“§ ç”Ÿæˆã•ã‚ŒãŸãƒ¡ãƒ¼ãƒ«æ–‡é¢
    
    {{ steps.assemble_email }}
    
    ---
    ğŸ“ ä½œæˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
    - ç›®çš„: {{ input.purpose }}
    - å—ä¿¡è€…: {{ input.recipient }}
    - ãƒˆãƒ¼ãƒ³: {{ input.tone }}
    
    ğŸ’¡ æ–‡è„ˆåˆ†æçµæœ
    {{ steps.analyze_context }}